<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office Pulse | ÂúòÈöäÂá∫Âã§Á¥ÄÈåÑ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css?v=fix1">
    <link rel="stylesheet" href="./css/batch_style.css?v=fix1">
    <link rel="stylesheet" href="./css/settings_style.css?v=fix1">
    <link rel="stylesheet" href="./css/responsive.css?v=fix1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase SDKs (Compat version for easiest integration without Node.js) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>

    <style>
        /* Mobile Specific Overrides in HTML to ensure highest priority */
        @media (max-width: 768px) {

            /* --- Mobile Scroll Fix (Aggressive) --- */
            html,
            body {
                height: 100%;
                overflow: hidden;
                /* App container handles scroll */
            }

            #app {
                height: 100%;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }

            .dashboard-grid {
                display: block !important;
                /* Stack normally */
                height: auto !important;
                max-height: none !important;
                overflow: visible !important;
                padding-bottom: 80px;
                /* Big padding for bottom scroll */
            }

            /* Disable internal scrolling for Calendar on mobile -> Let it expand */
            .calendar-days {
                overflow: visible !important;
                height: auto !important;
                flex: none !important;
                display: grid !important;
                /* Keep grid layout */
            }

            .calendar-section {
                height: auto !important;
                max-height: none !important;
                overflow: visible !important;
                margin-bottom: 20px;
            }

            .sidebar-section {
                height: auto !important;
                max-height: none !important;
                overflow: visible !important;
                margin-top: 20px;
            }

            #login-screen {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 9999;
                display: flex !important;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background: #f8fafc;
            }

            #login-screen:not(.active) {
                display: none !important;
            }

            /* Ensure Dashboard is HIDDEN on load */
            #dashboard-screen:not(.active) {
                display: none !important;
            }

            .login-panel {
                background: white;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                border-radius: 16px;
                width: 90%;
            }
        }
    </style>
</head>

<body>
    <div class="app-background">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div id="app">
        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="glass-panel login-panel">
                <div class="brand">
                    <i class="fa-solid fa-bolt pulse-icon"></i>
                    <h1>Office Pulse</h1>
                </div>
                <p class="subtitle">ÂêåÊ≠•‰Ω†ÁöÑÂá∫Âã§ÁãÄÊÖãÔºåÂáùËÅöÂúòÈöäÂêëÂøÉÂäõ„ÄÇ</p>

                <form id="login-form">
                    <div class="input-group">
                        <i class="fa-regular fa-user"></i>
                        <input type="text" id="username" placeholder="Â∏≥Ëôü" required value="Alex">
                    </div>
                    <div class="input-group">
                        <i class="fa-solid fa-lock"></i>
                        <input type="password" id="password" placeholder="ÂØÜÁ¢º" value="password">
                    </div>
                    <button type="submit" class="btn-primary">ÁôªÂÖ• <i class="fa-solid fa-arrow-right"></i></button>
                </form>

                <div class="demo-hint">
                    <small>Ë©¶Ë©¶‰ΩøÁî® "Alex", "Sam", Êàñ "Jordan" ÁôªÂÖ•</small>
                </div>
            </div>
        </div>

        <!-- Dashboard Screen -->
        <div id="dashboard-screen" class="screen">
            <header class="top-bar">
                <div class="brand-small">
                    <i class="fa-solid fa-bolt pulse-icon-small"></i>
                    <span>Office Pulse</span>
                </div>
                <div style="flex:1"></div>
                <button id="stats-btn" class="btn-icon" style="margin-right: 1rem;">
                    <i class="fa-solid fa-chart-pie"></i> Â†±Ë°®
                </button>
                <button id="btn-app-header" class="btn-icon" style="margin-right: 1rem;" title="Áî≥Ë´ã‰ΩúÊ•≠"
                    onclick="if(window.openApplicationsModal) window.openApplicationsModal()"><i
                        class="fa-solid fa-file-signature"></i> Áî≥Ë´ã</button>
                <div class="user-profile">
                    <span id="current-user-name">Alex M.</span>
                    <div class="avatar-small" id="current-user-avatar">AM</div>
                    <button id="settings-btn" class="btn-icon" title="Ë®≠ÂÆö"
                        onclick="if(window.openSettings) window.openSettings();"><i
                            class="fa-solid fa-gear"></i></button>
                    <button id="logout-btn" class="btn-icon" title="ÁôªÂá∫"><i
                            class="fa-solid fa-right-from-bracket"></i></button>
                </div>
            </header>

            <main class="dashboard-grid">
                <!-- Main Calendar Section -->
                <section class="calendar-section glass-panel">
                    <div class="calendar-header">
                        <!-- Perpetual Calendar Controls -->
                        <div style="display:flex; gap:10px; align-items:center;">
                            <button id="calendar-prev-btn" class="btn-icon"
                                style="background:none; border:none; color:#64748b; cursor:pointer; font-size: 0.9rem;"><i
                                    class="fa-solid fa-chevron-left"></i> ‰∏äÊúà</button>
                            <select id="calendar-year-select" class="form-input"
                                style="width:auto; font-size:1.2rem; font-weight:bold; padding:5px 10px;"></select>
                            <select id="calendar-month-select" class="form-input"
                                style="width:auto; font-size:1.2rem; font-weight:bold; padding:5px 10px;">
                                <option value="0">1Êúà</option>
                                <option value="1">2Êúà</option>
                                <option value="2">3Êúà</option>
                                <option value="3">4Êúà</option>
                                <option value="4">5Êúà</option>
                                <option value="5">6Êúà</option>
                                <option value="6">7Êúà</option>
                                <option value="7">8Êúà</option>
                                <option value="8">9Êúà</option>
                                <option value="9">10Êúà</option>
                                <option value="10">11Êúà</option>
                                <option value="11">12Êúà</option>
                            </select>
                            <button id="calendar-next-btn" class="btn-icon"
                                style="background:none; border:none; color:#64748b; cursor:pointer; font-size: 0.9rem;">‰∏ãÊúà
                                <i class="fa-solid fa-chevron-right"></i></button>
                            <button id="today-btn" class="btn-text"
                                style="font-size:0.9rem; border: 1px solid #94a3b8; border-radius: 20px; padding: 4px 12px;">ÂõûÂà∞‰ªäÂ§©</button>
                        </div>

                        <div class="calendar-controls" style="display:flex; gap:10px; align-items:center;">
                            <!-- Batch Mode Toggle -->
                            <button id="batch-mode-btn" class="btn-icon" title="ÈñãÂïüÂ§öÈÅ∏Ê®°ÂºèÔºå‰∏ÄÊ¨°Á∑®ËºØÂ§öÂ§©"
                                style="border-radius:20px; padding: 0.4rem 1rem; font-size:0.85rem;">
                                <i class="fa-regular fa-square-check"></i> Â§öÈÅ∏Ê®°Âºè: <span id="batch-status">Èóú</span>
                            </button>
                        </div>
                    </div>

                    <div class="calendar-grid-header">
                        <div>Êó•</div>
                        <div>‰∏Ä</div>
                        <div>‰∫å</div>
                        <div>‰∏â</div>
                        <div>Âõõ</div>
                        <div>‰∫î</div>
                        <div>ÂÖ≠</div>
                    </div>
                    <div id="calendar-days" class="calendar-days">
                        <!-- Days will be injected here -->
                    </div>
                </section>

                <!-- Sidebar: Today's Pulse -->
                <aside class="sidebar-section">
                    <!-- Status Widget (Right Sidebar) -->
                    <aside class="status-widget glass-panel">
                        <div class="widget-header">
                            <h3>ÊàëÁöÑÁãÄÊÖãÔºö<span class="highlight-text">‰ªäÂ§©</span></h3>

                            <!-- Clock In/Out Section -->
                            <div class="clock-section"
                                style="background: #f1f5f9; padding: 10px; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <div id="clock-status-text"
                                        style="font-size: 0.85rem; color: #64748b; font-weight: 600;">Â∞öÊú™ÊâìÂç°</div>
                                    <div id="clock-time-display"
                                        style="font-size: 1.1rem; color: #0f172a; font-weight: 700; font-family: monospace;">
                                        --:--</div>
                                </div>
                                <button id="btn-clock-action" class="btn-primary"
                                    style="padding: 0.5rem 1rem; font-size: 0.9rem; background: #3b82f6;">
                                    <i class="fa-solid fa-stopwatch"></i> ‰∏äÁè≠
                                </button>
                            </div>

                            <input type="text" id="day-event-input" class="event-input-small"
                                placeholder="Ôºã Êñ∞Â¢ûÂÖ¨Âè∏Â§ßË®ò‰∫ã (Â¶Ç: ÂÆ¢Êà∂‰æÜË®™)...">
                        </div>

                        <!-- User Selector for Admin Mode (Hidden by default) -->
                        <div id="admin-user-selector" class="form-group hidden" style="margin-bottom:1rem;">
                            <label style="font-size:0.85rem; color:#64748b;">Âπ´Ë™∞ÊéíÁè≠Ôºü</label>
                            <select id="target-user-select" class="form-input" style="padding:0.4rem;">
                                <!-- Injected -->
                            </select>
                        </div>

                        <!-- Main Status Buttons (Text) -->
                        <div class="status-buttons" style="grid-template-columns: repeat(5, 1fr);">
                            <button class="status-btn office" data-status="office" title="ÈÄ≤Ëæ¶ÂÖ¨ÂÆ§">
                                <span>Ëæ¶ÂÖ¨ÂÆ§</span>
                            </button>
                            <button class="status-btn remote" data-status="remote" title="Â±ÖÂÆ∂Ëæ¶ÂÖ¨">
                                <span>Â±ÖÂÆ∂</span>
                            </button>
                            <button class="status-btn trip" data-status="trip" title="Âá∫Â∑Æ">
                                <span>Âá∫Â∑Æ</span>
                            </button>
                            <button class="status-btn away" data-status="away" title="Ë´ãÂÅá">
                                <span>Ë´ãÂÅá</span>
                            </button>
                            <button class="status-btn other" onclick="updateSidebar('other')" data-status="other"
                                title="ÂÖ∂‰ªñ">
                                <span>ÊúÉË≠∞</span>
                            </button>
                        </div>

                        <!-- Dynamic Sub-Options (Chips) -->
                        <div id="sub-options-container" class="sub-options-container hidden">
                            <!-- Injected by JS -->
                        </div>

                        <!-- Time Configuration -->
                        <div class="time-config-container">
                            <label class="check-group">
                                <input type="checkbox" id="all-day-check" checked>
                                <span>ÂÖ®Â§©Ë°åÁ®ã</span>
                            </label>
                            <div class="time-inputs disabled" id="time-inputs-wrapper"
                                style="display: flex; gap: 5px; align-items: center;">
                                <div style="display:flex; gap:2px;">
                                    <select id="start-hour" class="form-input"
                                        style="width:50px; padding:2px;"></select>
                                    <span>:</span>
                                    <select id="start-min" class="form-input" style="width:50px; padding:2px;"></select>
                                </div>
                                <span style="margin:0 5px;">Ëá≥</span>
                                <div style="display:flex; gap:2px;">
                                    <select id="end-hour" class="form-input" style="width:50px; padding:2px;"></select>
                                    <span>:</span>
                                    <select id="end-min" class="form-input" style="width:50px; padding:2px;"></select>
                                </div>
                            </div>
                        </div>

                        <div class="note-container">
                            <div id="location-inputs-container" style="display:none; gap: 5px; margin-bottom: 8px;">
                                <input type="text" id="status-loc-start" placeholder="Ëµ∑Èªû (Â¶Ç: Âè∞Âåó)" style="flex:1;">
                                <span style="align-self:center;">-</span>
                                <input type="text" id="status-loc-end" placeholder="ÁµÇÈªû (Â¶Ç: È´òÈõÑ)" style="flex:1;">
                            </div>
                            <div id="meeting-inputs-container"
                                style="display:none; gap: 5px; margin-bottom: 8px; flex-direction: column;">
                                <div style="display:flex; gap:5px;">
                                    <input type="text" id="status-meet-link" placeholder="ÊúÉË≠∞ÈÄ£Áµê (Google Meet)"
                                        style="flex:1;">
                                </div>
                                <div
                                    style="background: white; border: 1px solid #cbd5e1; border-radius: 6px; padding: 10px; margin-top: 5px;">
                                    <div
                                        style="font-weight:600; margin-bottom:5px; font-size:0.9rem; display:flex; justify-content:space-between;">
                                        <span>ÂèÉËàáÂêå‰ªÅ</span>
                                        <label style="cursor:pointer; color:#3b82f6;"><input type="checkbox"
                                                id="meet-check-all"> ÂÖ®ÈÅ∏</label>
                                    </div>
                                    <div id="meet-attendees-list"
                                        style="display:flex; flex-wrap:wrap; gap:10px; max-height:150px; overflow-y:auto;">
                                        <!-- Injected User Checkboxes -->
                                    </div>
                                </div>
                            </div>
                            <input type="text" id="status-note" placeholder="ÂÇôË®ª (ÈÅ∏Â°´)">
                            <button id="add-status-btn" class="btn-add"><i class="fa-solid fa-plus"></i> Êñ∞Â¢ûË°åÁ®ã</button>
                        </div>

                        <!-- My Current Day Segments -->
                        <ul id="my-segments-list" class="my-segments-list">
                            <!-- Segments injected here -->
                        </ul>

                        <!-- Team Status List -->
                        <div class="team-list-panel"
                            style="margin-top: 2rem; padding-top: 1rem; border-top: 2px solid #e2e8f0;">
                            <h3>‰ªäÊó•ÂúòÈöäÂãïÊÖã <span class="live-indicator">‚óè Âç≥ÊôÇ</span></h3>

                            <div class="status-group">
                                <h4 class="group-title office-title">üè¢ Ëæ¶ÂÖ¨ÂÆ§ <span class="count"
                                        id="count-office">0</span>
                                </h4>
                                <ul class="user-list" id="list-office"></ul>
                            </div>

                            <div class="status-group">
                                <h4 class="group-title remote-title">üè† Â±ÖÂÆ∂Ëæ¶ÂÖ¨ <span class="count"
                                        id="count-remote">0</span>
                                </h4>
                                <ul class="user-list" id="list-remote"></ul>
                            </div>

                            <div class="status-group">
                                <h4 class="group-title trip-title">üíº Âá∫Â∑Æ <span class="count" id="count-trip">0</span>
                                </h4>
                                <ul class="user-list" id="list-trip"></ul>
                            </div>

                            <div class="status-group">
                                <h4 class="group-title away-title">üå¥ Ë´ãÂÅá <span class="count" id="count-away">0</span>
                                </h4>
                                <ul class="user-list" id="list-away"></ul>
                            </div>

                            <div class="status-group">
                                <h4 class="group-title other-title">‚ö™ ÊúÉË≠∞ <span class="count" id="count-other">0</span>
                                </h4>
                                <ul class="user-list" id="list-other"></ul>
                            </div>
                        </div>
                    </aside>
            </main>
        </div>

        <!-- Map Modal -->
        <div id="map-modal" class="modal-overlay">
            <div class="modal-panel" style="max-width: 500px; height: 60vh; padding: 0;">
                <div class="modal-header"
                    style="padding: 1rem; border-bottom: 1px solid #e2e8f0; justify-content: space-between; display: flex;">
                    <h3 style="margin:0; font-size: 1.1rem;"><i class="fa-solid fa-location-dot"
                            style="color:#ef4444;"></i> ÊâìÂç°‰ΩçÁΩÆÈ©óË≠â</h3>
                    <button onclick="document.getElementById('map-modal').classList.remove('active')"
                        style="border:none; background:none; font-size:1.2rem; cursor:pointer;"><i
                            class="fa-solid fa-xmark"></i></button>
                </div>
                <div style="flex: 1; position: relative;">
                    <iframe id="map-frame" width="100%" height="100%" style="border:0;" loading="lazy"
                        allowfullscreen></iframe>

                    <!-- Status Overlay -->
                    <div id="map-status-overlay"
                        style="position: absolute; bottom: 20px; left: 10px; right: 10px; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                        <p id="map-status-text" style="margin: 0 0 10px; font-weight: bold; color: #334155;">Ê≠£Âú®ÂÆö‰Ωç...</p>
                        <button id="btn-confirm-clock" disabled class="btn-primary" style="width: 100%; opacity: 0.5;">
                            Á¢∫Ë™çÊâìÂç°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Modal -->
        <div id="stats-modal" class="modal-overlay" style="align-items: flex-start; padding-top: 2rem;">
            <div class="modal-panel"
                style="max-width: 1200px; width: 95%; height: 90vh; display: flex; flex-direction: column; padding: 0;">
                <div class="modal-header" style="flex-shrink: 0; padding: 1.5rem;">
                    <h2>ÊúàÂ∫¶Âá∫Âã§Á∏ΩË¶Ω</h2>
                    <button class="btn-close" id="close-stats-btn"><i class="fa-solid fa-xmark"></i></button>
                </div>

                <div class="modal-body" style="flex-grow: 1; overflow-y: auto; padding: 0 1.5rem 1.5rem 1.5rem;">
                    <div class="modal-tabs"
                        style="position: sticky; top: 0; background: white; z-index: 10; padding-top: 10px; margin-bottom: 1rem; border-bottom: 1px solid #e2e8f0;">
                        <button class="tab-btn active" id="tab-btn-summary">Áµ±Ë®àÁ∏ΩË°®</button>
                        <button class="tab-btn" id="tab-btn-detail">Ë©≥Á¥∞ËÄÉÂã§Á¥ÄÈåÑ</button>
                    </div>

                    <!-- Summary View -->
                    <div id="stats-summary-view" class="stats-table-container">
                        <div style="margin-bottom: 1rem; display: flex; align-items: center; gap: 10px;">
                            <label>Êúà‰ªΩÁµ±Ë®àÔºö</label>
                            <div style="display:flex; gap:5px; align-items:center;">
                                <input type="month" id="summary-month-select" class="form-input"
                                    style="width: auto; padding: 4px 8px;">
                                <button class="btn-secondary" style="padding: 4px 8px; font-size: 0.85rem;"
                                    onclick="changeMonth('summary-month-select', -1)">‰∏äÊúà</button>
                                <button class="btn-secondary" style="padding: 4px 8px; font-size: 0.85rem;"
                                    onclick="changeMonth('summary-month-select', 0)">Êú¨Êúà</button>
                                <button class="btn-secondary" style="padding: 4px 8px; font-size: 0.85rem;"
                                    onclick="changeMonth('summary-month-select', 1)">‰∏ãÊúà</button>
                            </div>
                            <button id="btn-query-summary" class="btn-primary"
                                style="padding: 0.4rem 0.8rem; font-size: 0.9rem;">
                                <i class="fa-solid fa-magnifying-glass"></i> Êü•Ë©¢
                            </button>
                        </div>
                        <table class="stats-table">
                            <thead>
                                <tr>
                                    <th>Âêå‰ªÅ</th>
                                    <th>üè¢ Ëæ¶ÂÖ¨ÂÆ§</th>
                                    <th>üè† Â±ÖÂÆ∂</th>
                                    <th>üíº Âá∫Â∑Æ</th>
                                    <th>üå¥ Ë´ãÂÅá</th>
                                    <th>Âá∫Âã§Áéá (Office)</th>
                                </tr>
                            </thead>
                            <tbody id="stats-table-body">
                                <!-- Injected -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Detail View -->
                    <div id="stats-detail-view" class="stats-table-container hidden">
                        <div
                            style="margin-bottom: 1rem; display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                            <label>Êü•ÁúãÂêå‰ªÅÔºö</label>
                            <select id="detail-user-select" class="form-input"
                                style="width: auto; padding: 4px 8px; min-width: 120px;">
                                <!-- Injected Users -->
                            </select>
                            <label style="margin-left: 10px;">Êúà‰ªΩÔºö</label>
                            <div style="display:flex; gap:5px; align-items:center;">
                                <input type="month" id="detail-month-select" class="form-input"
                                    style="width: auto; padding: 4px 8px;">
                                <button class="btn-secondary" style="padding: 4px 8px; font-size: 0.85rem;"
                                    onclick="changeMonth('detail-month-select', -1)">‰∏äÊúà</button>
                                <button class="btn-secondary" style="padding: 4px 8px; font-size: 0.85rem;"
                                    onclick="changeMonth('detail-month-select', 0)">Êú¨Êúà</button>
                                <button class="btn-secondary" style="padding: 4px 8px; font-size: 0.85rem;"
                                    onclick="changeMonth('detail-month-select', 1)">‰∏ãÊúà</button>
                            </div>
                            <button id="btn-query-detail" class="btn-primary"
                                style="padding: 0.4rem 0.8rem; font-size: 0.9rem; margin-left: 10px;">
                                <i class="fa-solid fa-magnifying-glass"></i> Êü•Ë©¢
                            </button>
                        </div>
                        <table class="stats-table">
                            <thead>
                                <tr>
                                    <th>Êó•Êúü</th>
                                    <th>ÊòüÊúü</th>
                                    <th>ÁãÄÊÖã</th>
                                    <th>‰∏äÁè≠ÊâìÂç°</th>
                                    <th>‰∏ãÁè≠ÊâìÂç°</th>
                                    <th>Â∑•ÊôÇ</th>
                                </tr>
                            </thead>
                            <tbody id="detail-table-body">
                                <!-- Injected Detail Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal-overlay" style="align-items: flex-start; padding-top: 2rem;">
            <div class="modal-panel"
                style="max-width: 800px; width: 95%; height: 90vh; display: flex; flex-direction: column; padding: 0;">
                <div class="modal-header" style="flex-shrink: 0; padding: 1.5rem;">
                    <h2>Ë®≠ÂÆö‰∏≠ÂøÉ</h2>
                    <button class="btn-close" id="close-settings-btn"><i class="fa-solid fa-xmark"></i></button>
                </div>

                <div class="modal-body" style="flex-grow: 1; overflow-y: auto; padding: 0 1.5rem 1.5rem 1.5rem;">
                    <div class="modal-tabs"
                        style="position: sticky; top: 0; background: white; z-index: 10; padding-top: 10px; margin-bottom: 1rem; border-bottom: 1px solid #e2e8f0;">
                        <button class="tab-btn active" data-tab="tab-profile">ÂÄã‰∫∫Ë®≠ÂÆö</button>
                        <button class="tab-btn" data-tab="tab-team" id="tab-btn-team">ÂúòÈöäÁÆ°ÁêÜ</button>
                        <button class="tab-btn" data-tab="tab-reports" id="tab-btn-reports"
                            style="display:none;">Â†±Ë°®‰∏≠ÂøÉ</button>
                    </div>

                    <!-- Tab: Profile -->
                    <div id="tab-profile" class="tab-content active">
                        <div class="form-group">
                            <label>Â§ßÈ†≠Ë≤ºÈ†êË¶Ω</label>
                            <div class="avatar-upload-wrapper">
                                <div id="settings-avatar-preview" class="avatar-large">AM</div>
                                <div class="upload-controls">
                                    <label for="avatar-upload" class="btn-secondary">‰∏äÂÇ≥ÂúñÁâá</label>
                                    <input type="file" id="avatar-upload" accept="image/*" hidden>
                                    <button class="btn-text-danger" id="remove-avatar-btn">ÁßªÈô§ÂúñÁâá</button>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>È°ØÁ§∫Êö±Á®± (ÊúÄÂ§ö3Â≠ó)</label>
                            <input type="text" id="settings-nickname" class="form-input" maxlength="3"
                                placeholder="‰æãÂ¶Ç: Alex">
                        </div>

                        <div class="form-group">
                            <label>‰øÆÊîπÂØÜÁ¢º</label>
                            <input type="password" id="settings-password" class="form-input"
                                placeholder="Ëº∏ÂÖ•Êñ∞ÂØÜÁ¢º (ÁïôÁ©∫Ââá‰∏ç‰øÆÊîπ)">
                        </div>

                        <button id="save-profile-btn" class="btn-primary" style="margin-top: 1rem;">ÂÑ≤Â≠òËÆäÊõ¥</button>
                    </div>

                    <!-- Tab: Team -->
                    <div id="tab-team" class="tab-content">

                        <!-- Team List View -->
                        <div id="team-list-view">
                            <div class="form-group"
                                style="background: #f1f5f9; padding:1rem; border-radius:8px; margin-bottom:1rem; display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <label style="margin:0; font-weight:700; color:#334155;">ÁÆ°ÁêÜËÄÖÊ®°Âºè</label>
                                    <small style="color:#64748b; display:block;">ÈñãÂïüÂæåÂèØÂπ´Âêå‰∫ãÊéíÁè≠</small>
                                </div>
                                <label class="check-group">
                                    <input type="checkbox" id="admin-mode-check">
                                    <span style="font-size:0.9rem;">ÈñãÂïü</span>
                                </label>
                            </div>

                            <div
                                style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                                <p class="hint-text" style="margin:0;">ÈªûÊìäÁ∑®ËºØÊåâÈàï‰øÆÊîπË©≥Á¥∞Ë≥áÊñô</p>
                                <button id="btn-add-member" class="btn-primary"
                                    style="padding:0.4rem 0.8rem; font-size:0.9rem;"><i class="fa-solid fa-plus"></i>
                                    Êñ∞Â¢ûÂêå‰∫ã</button>
                            </div>

                            <ul id="team-settings-list" class="settings-list">
                                <!-- Injected -->
                            </ul>
                        </div>

                        <!-- Member Editor View (Hidden by default) -->
                        <div id="team-member-editor" class="hidden">
                            <div
                                style="display:flex; align-items:center; gap:10px; margin-bottom:1rem; border-bottom:1px solid #e2e8f0; padding-bottom:0.5rem;">
                                <button id="btn-back-team" class="btn-icon"><i
                                        class="fa-solid fa-arrow-left"></i></button>
                                <h3 id="editor-title" style="margin:0;">Á∑®ËºØÊàêÂì°</h3>
                            </div>

                            <div class="form-grid" style="display:grid; grid-template-columns: 1fr 1fr; gap:1rem;">
                                <div class="form-group"
                                    style="grid-column: span 2; display:flex; gap:1rem; align-items:center;">
                                    <div id="editor-avatar-preview" class="avatar-large"
                                        style="width:60px; height:60px; font-size:1.5rem;"></div>
                                    <div class="upload-controls">
                                        <label for="editor-avatar-upload" class="btn-secondary"
                                            style="font-size:0.8rem; padding:0.3rem 0.6rem;">ÊèõÈ†≠ÂÉè</label>
                                        <input type="file" id="editor-avatar-upload" accept="image/*" hidden>
                                        <button class="btn-text-danger" id="editor-remove-avatar">ÁßªÈô§</button>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>ÁôªÂÖ•Â∏≥Ëôü *</label>
                                    <input type="text" id="edit-username" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label>ÁôªÂÖ•ÂØÜÁ¢º</label>
                                    <input type="text" id="edit-password" class="form-input" placeholder="‰øùÁïôÂéüÂØÜÁ¢º">
                                </div>
                                <div class="form-group">
                                    <label>Email (ÊúÉË≠∞ÈÄöÁü•Áî®)</label>
                                    <input type="email" id="edit-email" class="form-input"
                                        placeholder="example@company.com">
                                </div>
                                <div class="form-group">
                                    <label>‰∏≠ÊñáÂßìÂêç *</label>
                                    <input type="text" id="edit-chiname" class="form-input" placeholder="‰æãÂ¶Ç: Èô≥Â§ßÊòé">
                                </div>
                                <div class="form-group">
                                    <label>ÁîüÊó•</label>
                                    <input type="date" id="edit-birthday" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label>È°ØÁ§∫Êö±Á®± (ÂàóË°®Áî®)</label>
                                    <input type="text" id="edit-nickname" class="form-input" placeholder="‰æãÂ¶Ç: Â§ßÊòéÂì•">
                                </div>
                                <div class="form-group">
                                    <label>Á∞°Á®± (Êó•ÊõÜÂúìÈªûÁî®, 1-2Â≠ó)</label>
                                    <input type="text" id="edit-shortname" class="form-input" maxlength="2"
                                        placeholder="‰æãÂ¶Ç: Êòé">
                                </div>
                                <div class="form-group">
                                    <label>ÈÉ®ÈñÄ/ËÅ∑Á®±</label>
                                    <select id="edit-department" class="form-input">
                                        <option value="">(Êú™Ë®≠ÂÆö)</option>
                                        <option value="Â∑•Á®ãÈÉ®‰∏ªÁÆ°">Â∑•Á®ãÈÉ®‰∏ªÁÆ°</option>
                                        <option value="Ê•≠ÂãôÈÉ®‰∏ªÁÆ°">Ê•≠ÂãôÈÉ®‰∏ªÁÆ°</option>
                                        <option value="ÂÆ¢ÊúçÈÉ®‰∏ªÁÆ°">ÂÆ¢ÊúçÈÉ®‰∏ªÁÆ°</option>
                                        <option value="‰∫∫‰∫ã‰∏ªÁÆ°">‰∫∫‰∫ã‰∏ªÁÆ°</option>
                                        <option value="Â∑•Á®ãÈÉ®ËÅ∑Âì°">Â∑•Á®ãÈÉ®ËÅ∑Âì°</option>
                                        <option value="Ê•≠ÂãôÂ∞àÂì°">Ê•≠ÂãôÂ∞àÂì°</option>
                                        <option value="ÂÆ¢ÊúçÂ∞àÂì°">ÂÆ¢ÊúçÂ∞àÂì°</option>
                                        <option value="ÁâπÂä©">ÁâπÂä©</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Áõ¥Â±¨‰∏ªÁÆ°</label>
                                    <select id="edit-manager" class="form-input">
                                        <!-- Injected by JS -->
                                    </select>
                                </div>

                                <!-- Geofencing Settings -->
                                <div
                                    style="grid-column: span 2; margin-top: 10px; border-top: 1px solid #e2e8f0; padding-top: 10px;">
                                    <label
                                        style="font-weight:bold; color:#1e293b; display:block; margin-bottom:8px;">ÊâìÂç°Âú∞ÈªûË®≠ÂÆö
                                        (Ëº∏ÂÖ•Âú∞ÂùÄËá™ÂãïÊäìÂ∫ßÊ®ô)</label>

                                    <!-- Location 1 -->
                                    <div style="background:#f8fafc; padding:8px; border-radius:8px; margin-bottom:8px;">
                                        <div
                                            style="font-size:0.85rem; font-weight:700; color:#64748b; margin-bottom:4px;">
                                            Âú∞Èªû 1</div>
                                        <div
                                            style="display:grid; grid-template-columns: 120px 1fr auto; gap:5px; margin-bottom:5px;">
                                            <input type="text" id="edit-loc1-label" class="form-input"
                                                placeholder="ÂêçÁ®± (Â¶Ç:Á∏ΩÈÉ®)">
                                            <input type="text" id="edit-loc1-addr" class="form-input"
                                                placeholder="Ëº∏ÂÖ•Âú∞ÂùÄ Êàñ Ë≤º‰∏äÂ∫ßÊ®ô (25.x, 121.x)">
                                            <button class="btn-secondary" id="btn-geo-1"
                                                style="font-size:0.8rem; padding:0 8px;"><i
                                                    class="fa-solid fa-location-dot"></i> ÊäìÂ∫ßÊ®ô/Ëß£Êûê</button>
                                        </div>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                                            <input type="text" id="edit-loc1-lat" class="form-input"
                                                placeholder="Á∑ØÂ∫¶ Lat (ÂèØÊâãÂãïËº∏ÂÖ•)">
                                            <input type="text" id="edit-loc1-lng" class="form-input"
                                                placeholder="Á∂ìÂ∫¶ Lng (ÂèØÊâãÂãïËº∏ÂÖ•)">
                                        </div>
                                        <div style="text-align:right; margin-top:2px;">
                                            <a href="https://www.google.com/maps" target="_blank"
                                                style="font-size:0.75rem; color:#3b82f6; text-decoration:none;"><i
                                                    class="fa-brands fa-google"></i> ÈñãÂïü Google Maps (Âè≥ÈçµË§áË£ΩÂ∫ßÊ®ô)</a>
                                        </div>
                                    </div>

                                    <!-- Location 2 -->
                                    <div style="background:#f8fafc; padding:8px; border-radius:8px; margin-bottom:8px;">
                                        <div
                                            style="font-size:0.85rem; font-weight:700; color:#64748b; margin-bottom:4px;">
                                            Âú∞Èªû 2</div>
                                        <div
                                            style="display:grid; grid-template-columns: 120px 1fr auto; gap:5px; margin-bottom:5px;">
                                            <input type="text" id="edit-loc2-label" class="form-input"
                                                placeholder="ÂêçÁ®± (Â¶Ç:ÂÆ∂‰∏≠)">
                                            <input type="text" id="edit-loc2-addr" class="form-input"
                                                placeholder="Ëº∏ÂÖ•Âú∞ÂùÄ Êàñ Ë≤º‰∏äÂ∫ßÊ®ô (25.x, 121.x)">
                                            <button class="btn-secondary" id="btn-geo-2"
                                                style="font-size:0.8rem; padding:0 8px;"><i
                                                    class="fa-solid fa-location-dot"></i> ÊäìÂ∫ßÊ®ô/Ëß£Êûê</button>
                                        </div>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                                            <input type="text" id="edit-loc2-lat" class="form-input" placeholder="Á∑ØÂ∫¶">
                                            <input type="text" id="edit-loc2-lng" class="form-input" placeholder="Á∂ìÂ∫¶">
                                        </div>
                                        <div style="text-align:right; margin-top:2px;">
                                            <a href="https://www.google.com/maps" target="_blank"
                                                style="font-size:0.75rem; color:#3b82f6; text-decoration:none;"><i
                                                    class="fa-brands fa-google"></i> ÈñãÂïü Google Maps (Âè≥ÈçµË§áË£ΩÂ∫ßÊ®ô)</a>
                                        </div>
                                    </div>

                                    <!-- Location 3 -->
                                    <div style="background:#f8fafc; padding:8px; border-radius:8px;">
                                        <div
                                            style="font-size:0.85rem; font-weight:700; color:#64748b; margin-bottom:4px;">
                                            Âú∞Èªû 3</div>
                                        <div
                                            style="display:grid; grid-template-columns: 120px 1fr auto; gap:5px; margin-bottom:5px;">
                                            <input type="text" id="edit-loc3-label" class="form-input"
                                                placeholder="ÂêçÁ®± (Â¶Ç:ÂÆ¢Êà∂A)">
                                            <input type="text" id="edit-loc3-addr" class="form-input"
                                                placeholder="Ëº∏ÂÖ•Âú∞ÂùÄ Êàñ Ë≤º‰∏äÂ∫ßÊ®ô">
                                            <button class="btn-secondary" id="btn-geo-3"
                                                style="font-size:0.8rem; padding:0 8px;"><i
                                                    class="fa-solid fa-location-dot"></i> ÊäìÂ∫ßÊ®ô/Ëß£Êûê</button>
                                        </div>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                                            <input type="text" id="edit-loc3-lat" class="form-input" placeholder="Á∑ØÂ∫¶">
                                            <input type="text" id="edit-loc3-lng" class="form-input" placeholder="Á∂ìÂ∫¶">
                                        </div>
                                        <div style="text-align:right; margin-top:2px;">
                                            <a href="https://www.google.com/maps" target="_blank"
                                                style="font-size:0.75rem; color:#3b82f6; text-decoration:none;"><i
                                                    class="fa-brands fa-google"></i> ÈñãÂïü Google Maps (Âè≥ÈçµË§áË£ΩÂ∫ßÊ®ô)</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Áõ¥Â±¨/Á∞ΩÊ†∏‰∏ªÁÆ°</label>
                                    <select id="edit-manager-select" class="form-input">
                                        <option value="">(ÁÑ°)</option>
                                        <!-- Injected via JS -->
                                    </select>
                                </div>

                                <div class="form-group" style="grid-column: span 2;">
                                    <label>Ê¨äÈôêË®≠ÂÆö</label>
                                    <div
                                        style="display: flex; gap: 15px; background: #f8fafc; padding: 10px; border-radius: 6px; flex-wrap: wrap;">
                                        <label class="check-group"><input type="checkbox" id="edit-perm-approve"> <span
                                                style="font-size:0.9rem;">Á∞ΩÊ†∏Ê¨äÈôê (ÂèØÁúãÂà∞Áõ¥Â±¨‰∏ãÂ±¨Áî≥Ë´ã)</span></label>
                                        <label class="check-group"><input type="checkbox" id="edit-perm-schedule"> <span
                                                style="font-size:0.9rem;">ÊéíÁè≠Ê¨äÈôê</span></label>
                                        <label class="check-group"><input type="checkbox" id="edit-perm-manage"> <span
                                                style="font-size:0.9rem;">Â∏≥ËôüÁÆ°ÁêÜ</span></label>
                                        <label class="check-group" style="color: #b91c1c;"><input type="checkbox"
                                                id="edit-perm-super"> <span
                                                style="font-size:0.9rem; font-weight:bold;">ÊúÄÂ§ßÊ¨äÈôê (Êü•ÁúãÊâÄÊúâÁî≥Ë´ã)</span></label>
                                    </div>
                                </div>
                            </div>

                            <div style="margin-top:1.5rem; display:flex; gap:10px; justify-content:flex-end;">
                                <button id="btn-delete-member" class="btn-text-danger"
                                    style="margin-right:auto;">Âà™Èô§Ê≠§‰∫∫</button>
                                <button id="btn-cancel-edit" class="btn-secondary">ÂèñÊ∂à</button>
                                <button id="btn-save-member" class="btn-primary">ÂÑ≤Â≠ò</button>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Reports -->
                    <div id="tab-reports" class="tab-content">
                        <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            <h3 style="margin-top:0; color:#334155; margin-bottom:15px;">Âá∫Â∑ÆË≤ªÁî®ÂΩôÊï¥Â†±Ë°®</h3>
                            <div style="display:flex; gap:15px; flex-wrap:wrap; align-items:end;">
                                <div>
                                    <label
                                        style="display:block; font-size:0.9rem; margin-bottom:5px; font-weight:600;">ÈÅ∏ÊìáÊúà‰ªΩ</label>
                                    <div style="display:flex; gap:5px; align-items:center;">
                                        <input type="month" id="report-month-select" class="form-input"
                                            style="width: auto;">
                                        <button class="btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;"
                                            onclick="changeMonth('report-month-select', -1)">‰∏äÊúà</button>
                                        <button class="btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;"
                                            onclick="changeMonth('report-month-select', 0)">Êú¨Êúà</button>
                                        <button class="btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;"
                                            onclick="changeMonth('report-month-select', 1)">‰∏ãÊúà</button>
                                    </div>
                                </div>
                                <div>
                                    <label
                                        style="display:block; font-size:0.9rem; margin-bottom:5px; font-weight:600;">ÈÅ∏Êìá‰∫∫Âì°</label>
                                    <select id="report-user-select" class="form-input" style="min-width:150px;">
                                        <option value="">ÂÖ®ÈÉ®‰∫∫Âì°</option>
                                    </select>
                                </div>
                                <button id="btn-generate-report" class="btn-primary"><i class="fa-solid fa-table"></i>
                                    Áî¢ÁîüÈ†êË¶Ω</button>
                                <button id="btn-export-excel" class="btn-success"
                                    style="background:#15803d; margin-left:auto; display:none;"><i
                                        class="fa-solid fa-file-excel"></i> ÂåØÂá∫ Excel</button>
                            </div>
                        </div>

                        <div id="report-preview-container"
                            style="overflow-x:auto; border:1px solid #e2e8f0; border-radius:8px;">
                            <table class="stats-table" id="report-preview-table" style="min-width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Êó•Êúü</th>
                                        <th>ÊîØÂá∫</th>
                                        <th>Êî∂ÂÖ•</th>
                                        <th style="width:40%;">ÂÇôË®ª</th>
                                        <th>ÊÜëË≠âÁ∑®Ëôü</th>
                                        <th>ÂèñÂæóÊÜëË≠âÁ®ÆÈ°û</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="6" style="text-align:center; padding:20px; color:#94a3b8;">
                                            Ë´ãÈÅ∏ÊìáÊ¢ù‰ª∂‰∏¶Áî¢ÁîüÂ†±Ë°®</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Backup & Restore Section -->
                    <div id="backup-section" class="settings-section"
                        style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                        <h4 style="margin-bottom: 0.5rem; color: #475569;">üì¶ Ë≥áÊñôÂÇô‰ªΩËàáÁßªËΩâ (ÊèõÈõªËÖ¶/ÊèõÁ∂≤ÂùÄÁî®)</h4>
                        <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 0.8rem;">
                            Â¶ÇÊûúÊòØÂæûËàäÁ∂≤ÂùÄË¶ÅÊèõÂà∞Êñ∞Á∂≤ÂùÄÔºåË´ãÂÖàÂõûËàäÁ∂≤ÂùÄÊåâ„ÄåÂåØÂá∫„ÄçÔºåÂ≠òÊàêÊ™îÊ°àÂæåÔºåÂÜç‰æÜÊñ∞Á∂≤ÂùÄÊåâ„ÄåÂåØÂÖ•„Äç„ÄÇ</p>
                        <div style="display: flex; gap: 8px;">
                            <button id="btn-export-data" class="btn-secondary"
                                style="background: #f1f5f9; border: 1px solid #cbd5e1;"><i
                                    class="fa-solid fa-download"></i> ÂåØÂá∫ÁõÆÂâçË≥áÊñô</button>
                            <button id="btn-import-data" class="btn-secondary"
                                style="background: #f1f5f9; border: 1px solid #cbd5e1;"><i
                                    class="fa-solid fa-upload"></i> ÂåØÂÖ•ÂÇô‰ªΩÊ™îÊ°à</button>
                            <input type="file" id="import-file-input" style="display: none" accept=".json">
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Applications Modal -->
        <div id="applications-modal" class="modal-overlay" style="align-items: flex-start; padding-top: 2rem;">
            <div class="modal-panel"
                style="max-width: 1200px; width: 95%; height: 90vh; display: flex; flex-direction: column; padding: 0;">
                <div class="modal-header" style="flex-shrink: 0; padding: 1.5rem;">
                    <h2>üìã Áî≥Ë´ãËàáÁ∞ΩÊ†∏‰∏≠ÂøÉ</h2>
                    <button class="btn-close" id="close-applications-btn"><i class="fa-solid fa-xmark"></i></button>
                </div>

                <div class="modal-body" style="flex-grow: 1; overflow-y: auto; padding: 0 1.5rem 1.5rem 1.5rem;">
                    <div class="modal-tabs"
                        style="position: sticky; top: 0; background: white; z-index: 10; padding-top: 10px;">
                        <button class="tab-btn active" data-tab="tab-app-correction">Ë£úÊâìÂç°Áî≥Ë´ã</button>
                        <button class="tab-btn" data-tab="tab-app-expense">Âá∫Â∑ÆË≤ªÁî≥Ë´ã</button>
                        <button class="tab-btn" data-tab="tab-app-history">Áî≥Ë´ãÁ¥ÄÈåÑ/Á∞ΩÊ†∏</button>
                    </div>

                    <!-- Tab: Correction -->
                    <div id="tab-app-correction" class="tab-content active"
                        style="max-width: 600px; margin: 0 auto; padding-top: 20px;">
                        <div class="alert-box">
                            <i class="fa-solid fa-circle-info"></i> Áî≥Ë´ãÊ†∏ÂáÜÂæåÔºåÁ≥ªÁµ±Â∞áËá™Âãï‰øÆÊ≠£ÊâìÂç°Á¥ÄÈåÑËàáÂ†±Ë°®„ÄÇ
                        </div>
                        <div class="form-group">
                            <label>Ë£úÂç°Êó•Êúü</label>
                            <input type="date" id="app-correct-date" class="form-input">
                        </div>
                        <div class="form-row">
                            <div class="form-group" style="flex:1;">
                                <label>‰∏äÁè≠ÊôÇÈñì</label>
                                <input type="time" id="app-correct-in" class="form-input">
                            </div>
                            <div class="form-group" style="flex:1;">
                                <label>‰∏ãÁè≠ÊôÇÈñì</label>
                                <input type="time" id="app-correct-out" class="form-input">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Áî≥Ë´ãÂéüÂõ†</label>
                            <textarea id="app-correct-reason" class="form-input" rows="3"
                                placeholder="‰æãÂ¶ÇÔºöÂøòË®òÊâìÂç°„ÄÅÁ≥ªÁµ±Áï∞Â∏∏..."></textarea>
                        </div>
                        <div style="text-align:right;">
                            <button id="btn-submit-correction" class="btn-primary">ÈÄÅÂá∫Áî≥Ë´ã</button>
                        </div>
                    </div>

                    <!-- Tab: Expense -->
                    <div id="tab-app-expense" class="tab-content" style="height: 100%;">
                        <div style="display: grid; grid-template-columns: 320px 1fr; gap: 25px; height: 100%;">
                            <!-- Left: Selection Panel -->
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px; height: fit-content;">
                                <h3
                                    style="margin-top: 0; font-size: 1.1rem; color: #334155; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; margin-bottom: 15px;">
                                    1. ÂãæÈÅ∏Âá∫Â∑ÆÊó•Êúü
                                </h3>
                                <div class="alert-box"
                                    style="margin-bottom: 15px; font-size: 0.9rem; padding: 8px 12px;">
                                    <i class="fa-solid fa-wand-magic-sparkles"></i> ÂãæÈÅ∏ÂæåËá™ÂãïÂ∏∂ÂÖ•‰∫ãÁî±
                                </div>
                                <div id="app-expense-dates-container"
                                    style="max-height: 250px; overflow-y: auto; background: white; border: 1px solid #cbd5e1; border-radius: 6px; padding: 10px;">
                                    <!-- Checkboxes -->
                                </div>
                                <div class="form-group" style="margin-top: 20px;">
                                    <label style="font-weight: 600; color: #475569;">Âá∫Â∑Æ‰∫ãÁî±</label>
                                    <textarea id="app-expense-main-reason" class="form-input" rows="5"
                                        style="resize: vertical;" placeholder="Á≥ªÁµ±Ëá™ÂãïÂ∏∂ÂÖ•..."></textarea>
                                </div>
                            </div>

                            <!-- Right: Items Panel -->
                            <div style="display: flex; flex-direction: column;">
                                <h3
                                    style="margin-top: 0; font-size: 1.1rem; color: #334155; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; margin-bottom: 15px;">
                                    2. Ë≤ªÁî®ÊòéÁ¥∞
                                </h3>

                                <!-- Add Form -->
                                <div
                                    style="background: white; border: 1px solid #cbd5e1; border-radius: 8px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);">
                                    <div
                                        style="display: grid; grid-template-columns: 140px 110px 130px 1fr 100px 50px; gap: 10px; align-items: end;">
                                        <div>
                                            <label
                                                style="font-size: 0.85rem; color: #64748b; font-weight: 600; margin-bottom: 4px; display: block;">Êó•Êúü</label>
                                            <select id="exp-item-date" class="form-input" style="width: 100%;">
                                                <option>Ë´ãÂÖàÈÅ∏Â∑¶ÂÅ¥</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label
                                                style="font-size: 0.85rem; color: #64748b; font-weight: 600; margin-bottom: 4px; display: block;">È°ûÂà•</label>
                                            <select id="exp-item-cat" class="form-input" style="width: 100%;">
                                                <option value="traffic">‰∫§ÈÄöË≤ª</option>
                                                <option value="accommodation">‰ΩèÂÆøË≤ª</option>
                                                <option value="meal">ËÜ≥ÈõúË≤ª</option>
                                                <option value="other">ÂÖ∂‰ªñ</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label
                                                style="font-size: 0.85rem; color: #64748b; font-weight: 600; margin-bottom: 4px; display: block;">ÊÜëË≠âÈ°ûÂûã</label>
                                            <select id="exp-item-type" class="form-input" style="width: 100%;">
                                                <option value="Ë≥ºÁ•®Ë≠âÊòé">Ë≥ºÁ•®Ë≠âÊòé</option>
                                                <option value="‰πòËªäË≠âÊòé">‰πòËªäË≠âÊòé</option>
                                                <option value="ÂØ¶È´îÁ•®Ê†π">ÂØ¶È´îÁ•®Ê†π</option>
                                                <option value="ÈõªÂ≠êÁôºÁ•®">ÈõªÂ≠êÁôºÁ•®</option>
                                                <option value="Êî∂Êìö">Êî∂Êìö</option>
                                                <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label
                                                style="font-size: 0.85rem; color: #64748b; font-weight: 600; margin-bottom: 4px; display: block;">Ë™™Êòé
                                                (ÂèØË©≥Ëø∞)</label>
                                            <input type="text" id="exp-item-desc" class="form-input"
                                                style="width: 100%;" placeholder="‰æãÂ¶Ç: È´òÈêµ Âè∞Âåó-Â∑¶Ááü ÂñÆÁ®ãÁ•®">
                                        </div>
                                        <div>
                                            <label
                                                style="font-size: 0.85rem; color: #64748b; font-weight: 600; margin-bottom: 4px; display: block;">ÈáëÈ°ç</label>
                                            <input type="number" id="exp-item-amount" class="form-input"
                                                style="width: 100%; font-family: monospace; font-weight: 700;"
                                                placeholder="$">
                                        </div>
                                        <button id="btn-add-exp-item" class="btn-primary"
                                            style="height: 38px; width: 100%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;"><i
                                                class="fa-solid fa-plus"></i></button>
                                    </div>
                                </div>

                                <!-- List -->
                                <div
                                    style="flex-grow: 1; border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column;">
                                    <div style="overflow-y: auto; flex-grow: 1;">
                                        <table class="stats-table"
                                            style="margin: 0; border: none; width: 100%; table-layout: fixed;">
                                            <thead style="position: sticky; top: 0; z-index: 5;">
                                                <tr>
                                                    <th style="width: 130px; white-space: nowrap;">Êó•Êúü</th>
                                                    <th style="width: 100px; white-space: nowrap;">È°ûÂà•</th>
                                                    <th>Ë™™Êòé</th>
                                                    <th style="width: 120px; white-space: nowrap;">ÈáëÈ°ç</th>
                                                    <th style="width: 60px;"></th>
                                                </tr>
                                            </thead>
                                            <tbody id="app-expense-items-tbody">
                                                <!-- Dynamic Items -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <div
                                        style="background: #f8fafc; padding: 15px 20px; border-top: 2px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
                                        <div style="color: #64748b; font-size: 0.9rem;">
                                            <i class="fa-solid fa-circle-info"></i> Á¢∫Ë™çÁÑ°Ë™§ÂæåË´ãÈÄÅÂá∫
                                        </div>
                                        <div style="font-size: 1.25rem; font-weight: 700; color: #334155;">
                                            Áî≥Ë´ãÁ∏ΩÈ°çÔºö <span id="exp-total-display"
                                                style="color: #2563eb; font-size: 1.5rem;">$0</span>
                                        </div>
                                    </div>
                                </div>

                                <div style="text-align: right; margin-top: 20px;">
                                    <button id="btn-generate-pdf" class="btn-secondary"
                                        style="padding: 12px 20px; font-size: 1rem; border-radius: 6px; margin-right: 10px; background: #f1f5f9; border: 1px solid #cbd5e1;">
                                        <i class="fa-solid fa-print"></i> Áî¢Áîü PDF Â†±Ë°®
                                    </button>
                                    <button id="btn-submit-expense" class="btn-primary"
                                        style="padding: 12px 30px; font-size: 1.1rem; border-radius: 6px;">
                                        <i class="fa-regular fa-paper-plane"></i> ÈÄÅÂá∫Áî≥Ë´ãÂñÆ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: History/Approval -->
                    <div id="tab-app-history" class="tab-content" style="padding-top: 20px;">
                        <div class="history-list-container">
                            <table class="stats-table">
                                <thead>
                                    <tr>
                                        <th>È°ûÂûã</th>
                                        <th>Áî≥Ë´ã‰∫∫/Êó•Êúü</th>
                                        <th>ÂÖßÂÆπË©≥Á¥∞</th>
                                        <th>ÁãÄÊÖã</th>
                                        <th>ÂØ©Ê†∏Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody id="app-history-tbody">
                                    <!-- Injected -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="./js/app.js?v=fix_mobile_clock_v2"></script>
</body>

</html>